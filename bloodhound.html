<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>BloodHound Lab | Kyle D. Hamilton</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <header>
    <nav>
      <h1>Kyle D. Hamilton</h1>
      <ul>
        <li><a href="index.html">About</a></li>
        <li><a href="projects.html">Projects</a></li>
      </ul>
    </nav>
  </header>

  <main class="container">
    <h2>üïµÔ∏è‚Äç‚ôÇÔ∏è AD Enumeration with BloodHound</h2>
    <p>
      This page outlines my process of performing Active Directory enumeration in a virtualized home lab using <strong>BloodHound</strong> and <code>bloodhound-python</code>. This included configuring a Windows Server 2022 Domain Controller (DC), setting up proper Kerberos authentication, and using LDAP to collect objects within the domain.
    </p>

    <h3>Lab Setup and Networking Configuration</h3>
    <p>
      The Domain Controller was hosted on Windows Server 2022 with the domain <code>mydomain.com</code>. It had two network adapters (NAT and Host-Only). To avoid conflicting IPs during resolution (e.g., DNS returning both <code>172.16.0.1</code> and <code>10.0.2.15</code>), I disabled the NAT adapter to isolate domain traffic to a single internal network. Kali Linux was connected to the same Host-Only network to interact with the DC.
    </p>

    <img src="screenshots/bloodhound/networking.png" alt="Networking Diagram Screenshot" width="700">

    <h3>DNS, Kerberos & LDAP Troubleshooting</h3>
    <p>
      I configured Kali‚Äôs <code>/etc/resolv.conf</code> to use the DC‚Äôs IP (<code>172.16.0.1</code>) as the DNS server. A valid Kerberos TGT was obtained via <code>kinit k-hamilton@MYDOMAIN.COM</code> and verified using <code>klist</code>. DNS resolution for <code>dc.mydomain.com</code> initially returned two IPs due to the dual NICs, which caused <code>invalid server address</code> errors in BloodHound. This was fixed by disabling the NAT adapter.
    </p>

    <img src="screenshots/bloodhound/klist.png" alt="klist Output Screenshot" width="700">

    <h3>BloodHound Enumeration</h3>
    <p>
      After resolving network and Kerberos issues, I successfully ran <code>bloodhound-python</code> from Kali Linux using the following command:
    </p>

    <pre><code>bloodhound-python -u k-hamilton@mydomain.com -p YeetSkeet1! -dc dc.mydomain.com -d mydomain.com -c All --dns-tcp</code></pre>

    <p>
      The tool collected data about users, groups, computers, sessions, ACLs, and trusts, outputting JSON files for visualization in the BloodHound GUI.
    </p>

    <img src="screenshots/bloodhound/bloodhoundgraph.png" alt="BloodHound Graph Screenshot" width="700">

    <h3>Lessons Learned</h3>
    <ul>
      <li>Importance of isolating network traffic in AD lab environments</li>
      <li>How dual NICs can interfere with DNS resolution and LDAP binding</li>
      <li>Kerberos ticket acquisition and troubleshooting with <code>kinit</code> and <code>klist</code></li>
      <li>Using <code>bloodhound-python</code> to enumerate AD objects via LDAP/Kerberos</li>
    </ul>

    <h3>Challenges Encountered</h3>
    <ul>
      <li>LDAP bind failures due to DNS returning multiple IPs for the DC</li>
      <li><code>LDAPSocketOpenError</code> caused by Kerberos misconfiguration and incorrect interface resolution</li>
      <li>Had to disable the NAT adapter and ensure static addressing on the Host-Only network</li>
    </ul>

    <p><a href="projects.html">‚¨Ö Back to Projects</a></p>
  </main>

  <footer>
    <p>&copy; 2025 Kyle D. Hamilton</p>
  </footer>
</body>
</html>
